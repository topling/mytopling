**This guide was tested on Alibaba Cloud Linux 3.2104 LTS 64 bit.**
# 0. Prerequisite
Install required packages.
```bash
sudo yum config-manager --set-enabled powertool
sudo yum install -y liburing-devel
sudo yum install -y openssl-devel \
                    ncurses-devel \
                    libtirpc-devel \
                    rpcgen \
                    bison \
                    libudev-devel
```

# 1. First build ToplingDB
```bash
  cd /path/to/topling # you should create this dir
  git clone https://github.com/topling/toplingdb.git
  cd toplingdb
  git submodule update --init --recursive
  make -j`nproc` DEBUG_LEVEL=0 shared_lib
  sudo make install-shared \
       PREFIX=/path/to/install/dir \
       LIBDIR=/path/to/install/dir/lib64
```
`PREFIX` and `LIBDIR` are optional for `make install-shared`:
`PREFIX`| default: `/usr/local`
--------|-----------------------
`LIBDIR`| default: `${PREFIX}/lib`

# 2. Build MyTopling
Now we have compiled [ToplingDB](https://github.com/topling/toplingdb) and [topling-zip](https://github.com/topling/topling-zip), MyTopling requires these two on compiling and running.

Please make sure repository toplingdb and mytopling are cloned to same parent dir(/path/to/topling).
## 2.1. Compile time dependencies(include dirs)
include dirs are auto added in mytopling `build.sh`.
```bash
 /path/to/toplingdb
 /path/to/toplingdb/include
 /path/to/toplingdb/sideplugin/rockside/src
 /path/to/toplingdb/sideplugin/topling-zip/src
```

## 2.2. Link and Run time dependencies(lib dirs)
You should have installed ToplingDB libs to `LIBDIR` above.
## 2.3. Calling cmake for release build
```bash
  cd /path/to/topling
  git clone https://github.com/topling/mytopling.git
  cd mytopling
  git submodule update --init --recursive
  export CXX_HOME=/usr
  bash build.sh -DTOPLING_LIB_DIR=/path/to/LIBDIR \
                -DCMAKE_INSTALL_PREFIX=/path/to/mytopling/install/dir
```

## 2.4. Calling make
MyTopling requires some libs generated by in compiling MyTopling, so we need to add such lib dirs to `LD_LIBRARY_PATH`.
```bash
  cd build-rls
  export LD_LIBRARY_PATH=`pwd`/lib:`pwd`/lib/plugin:plugin_output_directory
  make -j`nproc`
  sudo make install
```

# 3. Enjoy MyTopling
Now you can run MyTopling Server: [start\_mysqld.sh](storage/rocksdb/start_mysqld.sh)

To explore more feature of MyTopling Server, read and modify [mytopling.json](storage/rocksdb/mytopling.json).

Reference: [ToplingDB SidePlugin Manual](https://github.com/topling/rockside/wiki)





### 3.1. Download the script and configurations

[Download link](https://github.com/topling/mytopling/tree/topling-8.0.28-2022-10-12-9cc489f6/mytopling-conf)

```
conf_mysqld.sh
init_mysqld.sh
start_mysqld.sh
mytopling.json
```

You are advised to save the four files in the same directory (otherwise, you need to modify path-related configurations). 

I'm here under '/root/topling'.



### 3.2. Initialize

First determine where to start MyTopling. Here I am `/root/topling`:

```shell
cd /root/topling
```

Then determine where to store the data. Here I am `/root/mytopling/data` :

create data directory:

```shell
mkdir -p /root/mytopling/data
```

Execute:

```shell
bash init_mysqld.sh
```



### 3.3. Configure and run

Modify the `http`-> `document_root` field in `mytopling.json` to the data directory field above. For security, you can set a separate directory for log (mysql log, toplingdb log), and then set `document_root` to the log directory. If you don't want to access log files through the web, don't set `document_root`.

Then execute the startup script:

```shell
bash start_mysqld.sh
```



The final output is as follows to indicate success:

```
2022-11-04T10:37:59.557896Z 0 [System] [MY-010931] [Server] /home/terark/topling/mytopling-install/bin/mysqld: ready for connections. Version: '8.0.28'  socket: '/tmp/mysql.sock'  port: 3306  MyTopling Enterprise.
```

